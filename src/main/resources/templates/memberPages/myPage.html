<!DOCTYPE html>
<!--<html lang="en">-->
<html lang="en" xmlns:th="http://www.thymeleaf.org">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
    <meta name="_csrf_header" th:content="${_csrf.headerName}">
    <meta name="_csrf" th:content="${_csrf.token}">

    <!-- bootstrap -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.2.0/dist/css/bootstrap.min.css" rel="stylesheet"
          integrity="sha384-gH2yIJqKdNHPEq0n4Mqa/HGKIhSkIHeL5AyhkYV8i59U5AR6csBvApHHNl/vI1Bx" crossorigin="anonymous">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.9.1/font/bootstrap-icons.css">
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.2.0-beta1/dist/js/bootstrap.bundle.min.js"
            integrity="sha384-pprn3073KE6tl6bjs2QrFaJGz5/SUsLqktiwsUTF55Jfv3qYSDhgCecCxMW52nD2"
            crossorigin="anonymous"></script>
    <!-- jquery  -->
    <script src="https://code.jquery.com/jquery-3.6.0.js"
            integrity="sha256-H+K7U5CnXl1h5ywQfKtSj8PCmoN9aaq30gDh27Xc0jk=" crossorigin="anonymous"></script>
    <!-- font -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Poppins&display=swap" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+KR&display=swap" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Ibarra+Real+Nova:wght@700&display=swap" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Dosis:wght@600&family=Ibarra+Real+Nova:wght@700&display=swap"
          rel="stylesheet">

    <!-- fontawesome -->
    <script src="https://kit.fontawesome.com/827bb06556.js" crossorigin="anonymous"></script>
    <!-- emojionearea -->
    <script src=https://cdnjs.cloudflare.com/ajax/libs/emojionearea/3.4.2/emojionearea.min.js></script>
    <link rel="stylesheet" href=" https://cdnjs.cloudflare.com/ajax/libs/emojionearea/3.4.2/emojionearea.min.css">


    <style>
        body {
            -ms-overflow-style: none;
            font-family: 'Noto Sans KR', sans-serif;
            /*background-color: rgba(242, 243, 245, 0.75rem);*/
            overflow: hidden;
            -webkit-user-drag: none;

        }

        ::-webkit-scrollbar {
            display: none;
        }

        .mypageBody {
            width: 100%;
            max-width: 1000px;
            height: 100vh;
            overflow: scroll;
            margin: auto;
            margin-top: 27px;

        }

        .mypageProfile {
            /* margin: 1px; */
            width: 160px;
            height: 160px;
            border-radius: 50%;
            user-select: none;
            -webkit-user-drag: none;
            cursor: pointer;
            transition: ease-out 0.5s;

        }

        .mypageProfile:hover {
            filter: saturate(0.5);

        }

        .mypageProfile:active {
            transform: scale(0.98);
            transition: all 0s;
        }


        .mypageName {
            font-size: 30px;
        }

        .mypageUpdateBtn {
            /* border: 1px solid gray; */
            border: 1px solid rgb(226, 226, 226);
            border-radius: 5px;
            background-color: transparent;
            font-size: 15px;
            width: 130px;
            height: 35px;
            user-select: none;
            transition: ease-out 0.5s;


        }

        .mypageUpdateBtn:hover {
            /* background-color: rgb(230, 230, 230); */
            border: 1px solid gray;
            color: gray;
            transition: all 0.5s;
        }

        .mypageUpdateBtn:active {
            transform: scale(0.95);
            transition: all 0.1s;
        }

        .mypageFollowBtn {
            /* border: 1px solid gray; */
            border: 1px solid rgb(226, 226, 226);
            border-radius: 5px;
            background-color: transparent;
            font-size: 15px;
            width: 130px;
            height: 35px;
            user-select: none;
            transition: ease-out 0.2s;


        }

        .mypageFollowBtn:hover {
            /* background-color: rgb(230, 230, 230); */
            border: 1px solid gray;
            color: gray;
            transition: all 0.5s;
        }

        .mypageFollowBtn:active {
            transform: scale(0.95);
            transition: all 0.1s;

        }


        .mypageProfileZone {
            position: relative;
            top: 22px;
            left: 68px;

        }

        .mypageNameZone {
            position: relative;
            top: -130px;
            left: 294px;
        }

        .mypageUPdateZone {
            position: relative;
            top: -185px;
            left: 493px;
        }

        .mypageFollowZone {
            position: relative;
            top: -185px;
            left: 493px;
        }

        .countItem {
            font-size: 16px;
            margin-right: 10px;
        }

        .countItem1 {
            font-size: 17px;
            /* margin-right: 50px; */
        }

        .mypageCountZone {
            position: relative;
            top: -165px;
            left: 295px;
            user-select: none;
            -webkit-user-drag: none;
        }

        .aboutMe {
            position: relative;
            top: -155px;
            left: 293px;
            /* font-family: Arial, Helvetica, 'sans-serif'; */
            font-size: 19px;
            height: 100px;
            width: 340px;
            resize: none;
            border: 0;
            user-select: none;
            -webkit-user-drag: none;
            pointer-events: none;
        }

        .wrap {
            position: relative;
            width: 31%;
            max-width: 307px;
            min-width: 140px;
            background-color: black;
            /* opacity: 0.8; */
            padding: 1%;
            /* left: 2%;
            top:-100px; */
            z-index: 5000;
            transition: ease-out 0.5s;

        }


        .wrap:before {
            content: "";
            display: block;
            padding-top: 100%; /* 1:1 비율 */
        }

        .mypageListItem {
            position: absolute;
            top: 0;
            right: 0;
            bottom: 0;
            left: 0;
            /* background-color:blue; */
            overflow: hidden;
            max-width: 100%;
            min-height: 100%;
            height: auto;
            display: block;
            user-select: none;
            cursor: pointer;
            -webkit-user-drag: none;
        }


        .wrap:hover .listImg {
            opacity: 0.7;

        }

        .wrap:hover .imgIconGroup {
            opacity: 1;
            transition: all 0.5s;
        }

        .wrap:active .listImg {
            transform: scale(1.1);
            transition: all 0.3s;

        }

        .wrap:hover {
            transform: scale(1.1);
            transition: all 0.5s;
        }

        /* .wrap:active{
            transform: scale(0.95);
            transition: all 0.1s;
        } */


        .listImg {
            z-index: -1;
            transition: ease-out 1s;
        }


        .likeText2 {
            margin-left: 5px;
            margin-right: 6px;
        }

        .commentText1 {
            margin-left: 6px;
        }

        .commentText2 {
            margin-left: 5px;
        }

        .manyIcon {
            font-size: 23px;
            /* position: relative;
            top:5px;
            left: 275px;            */
            position: absolute;
            top: 2%;
            right: 2%
        }

        .imgIconGroup {
            color: white;
            font-size: 17px;
            /* font-size: 20px; */
            width: 121px;
            margin: auto !important;
            margin-top: 45% !important;
            opacity: 0;
            transition: ease-out 1s;
        }

        td {
            border-color: white;
            border-style: solid;
            border-width: 20px;
        }

        table {
            caption-side: bottom;
            border-collapse: collapse;
            position: relative;
            top: -89px;
        }

        .profileHeader {
            position: relative;
            top: -20px;
            -webkit-user-drag: none;
            user-select: none;
        }

        #dropUl {
            position: absolute;
            top: 10px !important;
        }

        .menuZone {
            /* background-color: yellow; */
            /* width: 500px;
            height: 70px; */
            position: absolute;
            top: 221px;
            left: 80px;
            display: flex;
            opacity: 0;
            z-index: 9999;
            border-radius: 5px;
        }

        .menuItemZone {
            margin-right: 30px;

            user-select: none;
            -webkit-user-drag: none;

        }

        .menuItem {
            font-size: 20px;
            cursor: pointer;
            transition: ease-out 0.5s;
            color: gray;

        }

        .menuItem:hover {
            color: black;
            transform: scale(1.2);
            transition: all 0.5s;

        }


    </style>

    <script>
        let showInt = 0

        function showMenu() {
            if (showInt == 0) {
                $("#menuZone").css({
                    "opacity": 1, "transition": "opacity 1.5s"
                })
                showInt = 1
            } else if (showInt == 1) {
                $("#menuZone").css({
                    "opacity": 0, "transition": "opacity 1s"
                })

                showInt = 0
            }
        }
    </script>


</head>

<body >
<div id="menuZone" class="menuZone" style="">
    <div class="menuItemZone">
        <b><p class="menuItem" onclick='location.href="/main/main"'>Home</p></b>
    </div>

    <div class="menuItemZone">
        <b><p class="menuItem" onclick='location.href="/member/updateForm"'>Update</p></b>
    </div>

    <div class="menuItemZone">
        <b><p class="menuItem" onclick="logoutChk()">Log-out</p></b>
    </div>


</div>
<!-- 팔로워 팔로우 모달 시작-->
<div class="modal fade" id="staticBackdrop" data-bs-backdrop="static" data-bs-keyboard="false" tabindex="-1"
     aria-labelledby="staticBackdropLabel" aria-hidden="true">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title" id="staticBackdropLabel">Modal title</h5>
                <button type="button" class="btn-close" data-bs-dismiss="modal"
                        aria-label="Close"></button>
            </div>
            <div class="modal-body" id="modal-body">

            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Close</button>
                <button type="button" class="btn btn-primary">Understood</button>
            </div>
        </div>
    </div>
</div>
<!-- 팔로워 팔로우 모달 끝-->


<div id="mypageBody" class="mypageBody">
    <!-- 내 정보 구역 시작-->
    <!-- 프로필 사진 -->
    <div id="mypageProfileZone" class="mypageProfileZone">
        <img onclick="showMenu()" id="mypageProfile" class="mypageProfile"
             th:src="@{|/upload/${memberDTO.memberProfileName}|}" alt="">
        <!--        <img onclick="showMenu()" id="mypageProfile" class="mypageProfile" src="https://image.ajunews.com/content/image/2021/07/30/20210730092316312062.jpg" alt="">-->

    </div>
    <div class="profileHeader">
        <!-- 프로필 이름 -->
        <div id="mypageNameZone" class="mypageNameZone">
            <p id="myPageLoginId" class="myPageLoginId" th:text="${memberDTO.loginId}" hidden></p>
            <p id="mypageName" class="mypageName" th:text="${memberDTO.memberName}"></p>
            <p id="AuthenticationId" class="AuthenticationId" th:text="${AuthenticationPrincipal.getMemberDTO().getLoginId()}"hidden></p>
            <!--            <p id="mypageName" class="mypageName" >havana 1016</p>-->
        </div>

        <!-- 프로필 편집 버튼 -->

        <!-- <div id="mypageUPdateZone" class="mypageUPdateZone">
            <button onclick="location.href='/member/updateForm'" id="mypageUpdateBtn" class="mypageUpdateBtn">프로필 편집</button>
        </div> -->
        <div id="btnZone">
        <div id="mypageFollowZone" class="mypageFollowZone">
            <button onclick="followBTN()" id="mypageFollowBtn" class="mypageFollowBtn">팔로잉</button>
        </div>
        </div>

        <!--카운트 구역  -->

        <!-- 게시물 카운트 구역 -->
        <div class="mypageCountZone input-group">
            <div style="display:flex ; margin-right: 50px;">
                <p class="countItem">게시물</p>
                <b><p id="mypageBoardCount" class="mypageBoardCount countItem1"></p></b>
            </div>

            <!-- 팔로워 카운트 구역 -->
            <div style="margin:0 50px 0 0 ;">
            <span onclick="followingList()" style="display:flex;height:25px;cursor: pointer;" data-bs-toggle="modal"
                  data-bs-target="#staticBackdrop">
                <p class="countItem" onclick="followingList()">팔로잉</p>
                <b><p id="mypageFollowerCount" class="mypageFollowerCount countItem1" th:text="${count}"></p></b>
            </span>
            </div>

            <!-- 팔로우 카운트 구역 -->
            <div style="margin:0;">
            <span onclick="followList()" style="display:flex;height:25px;cursor: pointer;" data-bs-toggle="modal"
                  data-bs-target="#staticBackdrop">
                <p class="countItem">팔로워</p>
                <b><p id="mypageFollowCount" class="mypageFollowCount countItem1" th:text="${countFw}"></p></b>
            </span>
            </div>
        </div>
        <!-- 게시물 카운트 구역 끝 -->


        <!-- 자기소개 -->
        <div id="aboutMe" class="">
            <!-- <t th:text="${memberDTO.memberIntro}"></p> -->
            <!--            <textarea class="aboutMe" readonly name="" id="">너에게 전화를 할까봐 오늘도 가사를 쓰고 있잖아</textarea>-->
            <textarea class="aboutMe" th:value="${memberDTO.memberIntro}" readonly name="" id=""></textarea>
        </div>
    </div>
    <!-- 이름 및 자기소개 끝-->
    <!-- 게시물 리스트 구역 시작-->

    <div class="mypageListZone">
        <!-- table 시작 -->
        <table style="height: 100%;width:100%">
            <tr id="detailFile">
<!--                 내게시물 시작-->

                <td class="wrap">
                    <div class="mypageListItem input-group">
                        <img class="mypageListItem listImg"
                             src=""
                             alt="" id="aa1">
                        <video class="mypageListItem listImg"
                             src="" autoplay="autoplay" loop="loop" alt="" id="aaa1"></video>
                        <i class="manyIcon fa-regular fa-clone"></i>

                        <div class="imgIconGroup " style="display:flex;text-align:center">
                            <div class="likeText1"><i class="fa-solid fa-heart"></i></div>
                            <div id="likeText1" class="likeText2">0</div>
                            <div class="commentText1"><i class="fa-solid fa-comment"></i></div>
                            <div class="commentText2">465</div>
                        </div>
                    </div>
                </td>

                <!-- 내게시물 끝 -->

                <!-- 내게시물 시작 -->

                <td class="wrap">
                    <div class="mypageListItem input-group">
                        <img class="mypageListItem listImg"
                             src="" alt="" id="aa2">
                        <video class="mypageListItem listImg"
                               src="" autoplay="autoplay" loop="loop" alt="" id="aaa2"></video>
                        <i class="manyIcon fa-regular fa-clone"></i>

                        <div class="imgIconGroup " style="display:flex;text-align:center">
                            <div class="likeText1"><i class="fa-solid fa-heart"></i></div>
                            <div id="likeText2" class="likeText2">0</div>
                            <div class="commentText1"><i class="fa-solid fa-comment"></i></div>
                            <div class="commentText2">465</div>
                        </div>
                    </div>
                </td>

                <!-- 내게시물 끝 -->

                <!-- 내게시물 시작 -->

                <td class="wrap">
                    <div class="mypageListItem input-group">
                        <img class="mypageListItem listImg"
                             src="" alt="" id="aa3">
                        <video class="mypageListItem listImg"
                               src="" autoplay="autoplay" loop="loop" alt="" id="aaa3"></video>
                        <i class="manyIcon fa-regular fa-clone"></i>

                        <div class="imgIconGroup " style="display:flex;text-align:center;">
                            <div class="likeText1"><i class="fa-solid fa-heart"></i></div>
                            <div id="likeText3" class="likeText2">0</div>
                            <div class="commentText1"><i class="fa-solid fa-comment"></i></div>
                            <div class="commentText2">465</div>
                        </div>
                    </div>
                </td>

<!--                <td class="wrap">-->
<!--                    <div class="mypageListItem input-group">-->
<!--                        <img class="mypageListItem listImg"-->
<!--                             src="" alt="" id="aa4">-->
<!--                        <video class="mypageListItem listImg"-->
<!--                               src="" autoplay="autoplay" loop="loop" alt="" id="aaa4"></video>-->
<!--                        <i class="manyIcon fa-regular fa-clone"></i>-->

<!--                        <div class="imgIconGroup " style="display:flex;text-align:center;">-->
<!--                            <div class="likeText1"><i class="fa-solid fa-heart"></i></div>-->
<!--                            <div id="likeText4" class="likeText2">0</div>-->
<!--                            <div class="commentText1"><i class="fa-solid fa-comment"></i></div>-->
<!--                            <div class="commentText2">465</div>-->
<!--                        </div>-->
<!--                    </div>-->
<!--                </td>-->

                <!-- 내게시물 끝 -->


            </tr>


        </table>
        <!-- table 끝 -->

    </div>


</div>


<!-- 게시물 리스트 구역 끝-->


<!-- 내 정보 구역 끝-->


</div>


</body>
<script>

    let yourId = document.getElementById("myPageLoginId").innerText;
    let yourName = document.getElementById("mypageName").innerText;
    let loginStatus = [[${memberDTO.loginStatus}]]
    const loginId = document.getElementById("myPageLoginId").innerText;
    let myId = document.getElementById("AuthenticationId").innerText;
  window.onload=  function BTN() {
      let header = $("meta[name='_csrf_header']").attr('content');
      let token = $("meta[name='_csrf']").attr('content');
      console.log("함수호출");


          var content;
      if (myId == yourId) {
          content='<div id="mypageUPdateZone" class="mypageUPdateZone"><button onClick="location.href='+"'/member/updateForm'"+'"id="mypageUpdateBtn" class="mypageUpdateBtn">프로필 편집</button></div>'
              // " <button onclick='location.href='/member/updateForm'' id='mypageFollowBtn' className='mypageFollowBtn'>" + "업데이트" + "</button>"
          document.getElementById("btnZone").innerHTML = content;
      } else {
          console.log("else");
          $.ajax({
              type: "get",
              url: "/follow/findByMyIdAndYourId",
              data: {
                  "yourId": yourId,
                  "myId": myId
              },
              dataType: "text",
              beforeSend: function (result) {
                  result.setRequestHeader(header, token);
              },
              success: function (result) {
                  console.log(result);
                  if (result == "찾음") {
                      content =' <div id="mypageFollowZone" class="mypageFollowZone">'+
                          '<button onClick="unFollowBTN()" id="mypageFollowBtn" class="mypageFollowBtn">팔로잉 취소</button></div>'
                          // " <button onClick=" + unFollowBTN() + " id='mypageFollowBtn' className='mypageFollowBtn'>" + "팔로우취소" + "</button>"
                      document.getElementById("btnZone").innerHTML = content;

                      function init() {
                      }

                  } else if (result == "못찾음") {
                      console.log("else,else");

                      content =' <div id="mypageFollowZone" class="mypageFollowZone">'+
                          '<button onClick="followBTN()" id="mypageFollowBtn" class="mypageFollowBtn">팔로잉</button></div>'
                      document.getElementById("btnZone").innerHTML = content;

                      function init() {
                      }
                  }
              }

          })
      }
      //
      //     $.ajax({
      //         type: "post",
      //         url: "/member/mypage",
      //         data: {
      //             "yourId": yourId,
      //             "myId": myId
      //         },
      //         beforeSend: function (result) {
      //             result.setRequestHeader(header, token);
      //         },
      //         success: function () {
      //             if (yourId == myId) {
      //                 content =
      //                     " <button onclick='location.href='/member/updateForm'' id='mypageFollowBtn' className='mypageFollowBtn'>" + "업데이트" + "</button>"
      //                 document.getElementById("mypageFollowZone").innerHTML = content;
      //             } else {
      //                 $.ajax({
      //                     type: "post",
      //                     url: "/follow/findByMyIdAndYourId",
      //                     dataType: "json",
      //                     data: {
      //                         "yourId": yourId,
      //                         "myId": myId
      //                     },
      //                     success: function (result) {
      //                         if (result != null) {
      //                             var content = "";
      //                             $.ajax({
      //                                 url: "/follow/delete",
      //                                 type: "delete",
      //                                 data: {
      //                                     "yourId": yourId,
      //                                     "myId": myId,
      //                                 },
      //                                 success: function () {
      //                                     // content =
      //                                     //     " <button onClick='followBTN()' id='mypageFollowBtn' className='mypageFollowBtn'>" + "팔로우" + "</button>"
      //                                     // document.getElementById("mypageFollowZone").innerHTML = content;
      //                                     // //리다이렉트 해봐바
      //                                 }
      //                             });
      //                         } else {
      //                             content =
      //                                 " <button onClick='followBTN()' id='mypageFollowBtn' className='mypageFollowBtn'>" + "팔로우" + "</button>"
      //                             document.getElementById("mypageFollowZone").innerHTML = content;
      //                         }
      //                     }
      //                 })
      //             }
      //         },
      //
      //     })
      // }


      function followBTN() {
          let header = $("meta[name='_csrf_header']").attr('content');
          let token = $("meta[name='_csrf']").attr('content');
          let yourId = document.getElementById("myPageLoginId").innerText;
          let yourName = document.getElementById("mypageName").innerText;
          let loginStatus = [[${memberDTO.loginStatus}]]
          var content = "";

          $.ajax({
              url: "/follow/request",
              type: "post",
              dataType: "json",
              data: {
                  "yourId": yourId,
                  "yourName": yourName,
                  "loginStatus": loginStatus
              },
              beforeSend: function (result) {
                  result.setRequestHeader(header, token);
              },
              success: function (result) {
                  content =
                      " <button onClick='unFollowBTN()' id='mypageFollowBtn' className='mypageFollowBtn'>" + "팔로우 취소" + "</button>"
                  document.getElementById("mypageFollowZone").innerHTML = content;
              },
              error: function (result) {
                  console.log("err");
              },
          })
      };

      function followList() {
          console.log("함수호출");
          let header = $("meta[name='_csrf_header']").attr('content');
          let token = $("meta[name='_csrf']").attr('content');
          const loginId = document.getElementById("myPageLoginId").innerText;
          console.log(loginId);

          $.ajax({
              type: "post",
              url: "/follow/yourList",
              data: {
                  "loginId": loginId
              },
              dataType: "json",
              beforeSend: function (result) {
                  result.setRequestHeader(header, token);
              }, success: function (result) {
                  console.log(result);
                  var content = "";
                  for (let i in result) {
                      content += "<a className='following' href='" + '/member/mypage?loginId=' +
                          result[i].myId + "'>" +
                          "<img src=\"" + '/upload/' + result[i].yourProfileName + "\">"
                          + result[i].yourName + "</a>" + "<br>";
                  }
                  document.getElementById("modal-body").innerHTML = content;
              }

          })
      }


      function followingList() {
          console.log("함수호출");
          let header = $("meta[name='_csrf_header']").attr('content');
          let token = $("meta[name='_csrf']").attr('content');
          const loginId = document.getElementById("myPageLoginId").innerText;
          console.log(loginId);

          $.ajax({
              type: "post",
              url: "/follow/myList",
              data: {
                  "loginId": loginId
              },
              dataType: "json",
              beforeSend: function (result) {
                  result.setRequestHeader(header, token);
              }, success: function (result) {
                  console.log(result);
                  var content = "";
                  for (let i in result) {
                      content += "<a className='following' href='" + '/member/mypage?loginId=' + result[i].yourId + "' > " +
                          "<img src=\"" + '/upload/' + result[i].yourProfileName + "\">"
                          + result[i].yourName + "</a>" + "<br>";
                  }
                  document.getElementById("modal-body").innerHTML = content;
              }

          })
      }

      function unFollowBTN() {
          console.log("함수호출");
          let header = $("meta[name='_csrf_header']").attr('content');
          let token = $("meta[name='_csrf']").attr('content');

          var content = "";
          $.ajax({
              url: "/follow/delete",
              type: "delete",
              data: {
                  "yourId": yourId,
                  "myId": myId,
              },
              beforeSend: function (result) {
                  result.setRequestHeader(header, token);
              },
              success: function () {
               location.href="/member/mapage?loginId="+yourId;
              }
          })
      }
  }
</script>
<script>
    function logoutChk() {
        let header = $("meta[name='_csrf_header']").attr('content');
        let token = $("meta[name='_csrf']").attr('content');
        console.log("logout chk 호출")
        $.ajax({
            url: "/member/logoutCheck",
            type: "get",
            beforeSend: function (result) {
                result.setRequestHeader(header, token);
            },
            success: function (e) {
                console.log("logout chk suc")
                location.href = "/member/logout"
            },
            error: function (e) {
                console.log("logout chk err")

            }

        })
    }
</script>
<!--<script th:inline="javascript">-->
<!--    $("#0").onclick=f(0);-->
<!--    function f () {-->
<!--        let header = $("meta[name='_csrf_header']").attr('content');-->
<!--        let token = $("meta[name='_csrf']").attr('content');-->
<!--        $.ajax({-->
<!--            type: "post",-->
<!--            url: "/board/detailFind",-->
<!--            dataType: "json",-->
<!--            beforeSend: function (result) {-->
<!--                result.setRequestHeader(header, token);-->
<!--            },-->
<!--            success: function (data) {-->
<!--                $.ajax({-->
<!--                    type: "post",-->
<!--                    url: "/board/count",-->
<!--                    dataType: "json",-->
<!--                    beforeSend: function (result) {-->
<!--                        result.setRequestHeader(header, token);-->
<!--                    },-->
<!--                    success: function (like) {-->
<!--                        const detailFile = document.getElementById("detailFile");-->
<!--                        let id = 1;-->
<!--                        let likeIndex = [];-->
<!--                        let lengthBoard = 1;-->
<!--                        let aa = 0;-->
<!--                        for (let i = 0; i < like.length; i++) {-->
<!--                            likeIndex[i] = 0;-->
<!--                        }-->
<!--                        for (let i = data.length-1; i >= 0; i&#45;&#45;) {-->
<!--                            aa = data[i].boardId;-->
<!--                            lengthBoard = id;-->
<!--                            for (let j = 0; j < like.length; j++) {-->
<!--                                if (like[j].boardId == aa) {-->
<!--                                    likeIndex[i]++;-->
<!--                                }-->
<!--                            }-->
<!--                            let file = '<td class="wrap">';-->
<!--                            file += '<div class="mypageListItem input-group">';-->
<!--                            if (data[i].boardId == aa) {-->
<!--                                if (data[i].boardImgName == null) {-->
<!--                                    file += '<video class="mypageListItem listImg" src="/upload/' + data[i].boardVideoName + '" autoplay="autoplay" loop="loop"></video>';-->
<!--                                }else {-->
<!--                                    file += '<img class="mypageListItem listImg" src="/upload/' + data[i].boardImgName + '" alt="">';-->
<!--                                }-->
<!--                                file += '<i class="manyIcon fa-regular fa-clone"></i>';-->
<!--                                file += '<div class="imgIconGroup " style="display:flex;text-align:center;">';-->
<!--                                file += '<div class="likeText1"><i class="fa-solid fa-heart"></i></div>';-->
<!--                                file += '<div class="likeText2">' + likeIndex[i] + '</div>';-->
<!--                                file += '<div class="commentText1"><i class="fa-solid fa-comment"></i></div>';-->
<!--                                file += '<div class="commentText2">465</div>';-->
<!--                                file += '</div>';-->
<!--                                file += '</div>';-->
<!--                                file += '</td>';-->
<!--                                id++;-->
<!--                                detailFile.innerHTML += file;-->
<!--                            }-->
<!--                        }-->
<!--                        document.getElementById("mypageBoardCount").innerHTML = lengthBoard;-->
<!--                    }-->
<!--                });-->
<!--            }-->
<!--        });-->
<!--    }-->

<!--</script>-->
<script th:inline="javascript">
    $("#0").onclick=f(0);
    function f () {
        let header = $("meta[name='_csrf_header']").attr('content');
        let token = $("meta[name='_csrf']").attr('content');
        $.ajax({
            type: "post",
            url: "/board/detailFind",
            dataType: "json",
            beforeSend: function (result) {
                result.setRequestHeader(header, token);
            },
            success: function (data) {
                $.ajax({
                    type: "post",
                    url: "/board/count",
                    dataType: "json",
                    beforeSend: function (result) {
                        result.setRequestHeader(header, token);
                    },
                    success: function (like) {
                        console.log(data);
                        let id = 1;
                        let likeIndex = [];
                        let lengthBoard = 1;
                        let aa = 0;
                        for (let i = 0; i < like.length; i++) {
                            likeIndex[i] = 0;
                        }
                        for (let i = data.length-1; i >= 0; i--) {
                            aa = data[i].boardId;
                            if (data[i].boardId == aa) {
                                if (data[i].boardImgName == null) {
                                    $("#aaa" + id).attr("src", /upload/ + data[i].boardVideoName);
                                }else {
                                    $("#aa" + id).attr("src", /upload/ + data[i].boardImgName);
                                }
                                lengthBoard = id;
                                const likes = document.getElementById("likeText"+id);
                                for (let j = 0; j < like.length; j++) {
                                    if (like[j].boardId == aa) {
                                        likeIndex[i]++;
                                        likes.innerHTML = "";
                                    }
                                }
                                likes.innerHTML = likeIndex[i];
                                id++;
                            }
                        }
                        document.getElementById("mypageBoardCount").innerHTML = lengthBoard;
                    }
                });
            }
        });
    }

</script>

</html>